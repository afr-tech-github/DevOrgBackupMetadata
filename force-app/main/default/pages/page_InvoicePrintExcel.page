<apex:page controller="InvoicePrintNewController"  applyBodyTag="false" applyHtmlTag="false"  showHeader="false" contentType="application/vnd.ms-excel#{!contentType}" cache="true">
    <!-- renderAs="advanced_pdf"  -->
    <head>
    <apex:includeScript value="{!URLFOR($Resource.CommonResource ,'CommonResource/Jquery/jquery.min.js')}"/>
        
        <style type="text/css" media="print">
            
            h1 {
                font-size: 300%;
            }
            body {
                font-size: 9pt
                font-family: "Arial Unicode MS", "MS Pゴシック", "ヒラギノ角ゴ Pro W3", "Hiragino Kaku Gothic Pro", Osaka, "メイリオ", Meiryo, "MS PGothic", sans-serif;
            }
            
            .invoice-logo {
            background-image: "{!URLFOR($Resource.invoice_logo_FMS, 'invoice_logo_FMS.png')}";
            }
            /* div.header {
            padding-top: 30px;
            position: running(header);
            
            } */
            
            div.footer {
            
            display: block;
            
            position: running(footer);
            
            }
            
            .pagenumber:before {
            
            content: counter(page);
            
            }
            
            .pagecount:before {
            
            content: counter(pages);
            
            }
            /* table td, table th{
            padding: 5px;
            } */
            .content-table,  .content-table tr{
            border: 1px solid black !important;
            border-collapse: collapse;
            
            }
            .content-table th{
            font-weight: bold;
            
            text-align: center;
            padding: 5px;
            }
            .content-table td{
            padding: 5px;
            line-height: 22px;
            min-height: 22px;
            }
            .border{
            	border: thin solid;
            	border-collapse: collapse;
            }
            .border-left{
            border-left: 1px solid black !important;
            }
            .border-right{
            border-right: 1px solid black !important;
            }
            .invoice-debit-info td, .shipment-detail td{
            padding: 0px !important;
            }
            .hide{
            display: none;
            }
            
            
        </style>
        <meta http-equiv="Content-Type" content="text/HTML;charset=UTF-8" />
    </head>
    <body>
        <apex:outputPanel rendered="{!templateType == 'official'}">
            <table>
                <tr>
                    <td colspan="1" style="width: 15px"></td>
                    <td colspan="2" rowspan="2">
                        
                        <img align="middle" src="{!$Setup.clofor_com_cfs__Site_Custom_Settings__c.clofor_com_cfs__Logo_URL__c}" width="200"/>
                        
                    </td>
                    <td colspan="7">
                        <!-- Company Info -->
                        <div style="width: 65%; float: left; padding-left: 15px; padding-right: 15px">
                            <apex:outputPanel rendered="{!language == 'en'}">
                                <div style="font-weight:bold; font-size:13pt;" >
                                    <apex:outputLabel value="{!$Setup.Site_Custom_Settings__c.Company_Name__c}"/>
                                </div>
                                <div style="padding-top: 10px; font-size:10pt">
                                    <apex:outputLabel value="{!$Setup.Site_Custom_Settings__c.Company_Address__c}"/>
                                </div>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!language != 'en'}">
                                <div style="font-weight:bold; font-size:13pt" >
                                    <apex:outputLabel style="white-space:pre-wrap;" value="{!$Setup.Site_Custom_Settings__c.EnglishCompanyAddressLine1__c}"/>
                                    <apex:outputLabel style="white-space:pre-wrap;" value="{!$Setup.Site_Custom_Settings__c.EnglishCompanyAddressLine2__c}"/>
                                </div>
                                <div style="padding-top: 10px; font-size:10pt">
                                    <apex:outputLabel value="{!$Setup.Site_Custom_Settings__c.Local_Company_Address__c}"/>
                                </div>
                            </apex:outputPanel>
                            <div tyle="padding-top: 10px; font-size:10pt">
                                <span><apex:outputLabel value="{!translations['tel']}/{!translations['fax']}: {!$Setup.Site_Custom_Settings__c.Company_Phone__c}/{!$Setup.Site_Custom_Settings__c.Company_Fax__c} 　　{!translations['tax_code']}: {!$Setup.Site_Custom_Settings__c.Tax_Code__c}"/></span>
                            </div>
                            
                        </div>
                    </td>
                </tr>
            </table>
        </apex:outputPanel>
            <table>
                <tr>
                    <td colspan="11" rowspan="2" align="center">
                        <div style="text-align: center; font-size: 16pt; clear: both; height: 50px; font-weight: bold">
                            <apex:outputText value="{!translations[typeDoc]}"/>
                            
                        </div>
                    </td>
                </tr>
            </table>
            <br/>
        <div class="content" style="clear: both; padding-top: 30px;">
            <table class="content-table" style="width: 100%; border: 1px solid black; border-collapse: collapse;">

                <!-- shipment general info -->
                <tr style="vertical-align:top !important; border: 1px solid black !important; ">
                    <td colspan="7" style="vertical-align:top; padding-top: 10px; max-width:75%; border-width: 1px 0px 1px 1px; border-style: solid; border-right:none">
                        
                        <apex:outputText value="{!translations['to']}: {!customer.EnglishCompanyName__c}" rendered="{!language == 'en'}"/>
                        <apex:outputText value="{!translations['to']}: {!customer.Name}" rendered="{!language != 'en'}"/>
                        <br/>
                        <apex:outputText value="{!translations['address']}: {!customer.EnglishAddress__c}" rendered="{!language == 'en'}"/>
                        <apex:outputText value="{!translations['address']} {!customerAddress}" rendered="{!language != 'en'}"/>
                        <br/>
                        <apex:outputLabel value="{!translations['tel']}/{!translations['fax']}: {!customer.Phone}/{!customer.Fax} 　　{!translations['tax_code']} {!customer.TAX_CODE__c}"/>
                        
                    </td>
                    <td colspan="4" style="vertical-align:top; padding-top: 10px; border-width: 0px 1px 1px 1px; border-style: solid; border-left:none">
                        <table class="invoice-debit-info">
                            <tr>
                                <td colspan="2">
                                    <apex:outputText value="{!translations['invoice_no']}" rendered="{!typeDoc == 'invoice'}"/>
                                    <apex:outputText value="{!translations['debit_no']}" rendered="{!typeDoc == 'debit'}"/>
                                </td>
                                <td colspan="2">
                                    <apex:outputText value=": "/><apex:outputText value="{!shipment.ID__c}-{!shipment.QuotationVer__c}"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <apex:outputText value="{!translations['job_no']}"/>
                                </td>
                                <td colspan="2">
                                    <apex:outputText value=": "/><apex:outputText value="{!shipment.JobRequestID__c}" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <apex:outputText value="{!translations['ref_no']}"/>
                                </td>
                                <td colspan="2">
                                    <apex:outputText value=": "/><apex:outputText value="{!shipment.REFNO__c}" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    
                                    <apex:outputText value="{!translations['book_date']}"/>
                                </td>
                                <td colspan="2">
                                    <apex:outputText value=": "/>
                                    <apex:outputText value="{!bookDateFormatted}" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <apex:outputText value="{!translations['payment_due_date']}"/>
                                </td>
                                <td colspan="2">
                                    <apex:outputText value=": "/>
                                    <apex:outputText value="{!paymentDueDateFormatted}" />
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                </table>
                <!-- Shipment Detail Info -->
                <table width="100%" class="shipment-detail" style="width: 100%; border: 1px solid black; border-collapse: collapse; ">
                    
                    
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['master_booking_no']}"/></td>
                        <td colspan="4"><apex:outputText value=": "/><apex:outputText value="{!shipment.MASTER_BOOKINGNO__c}"/></td>
                        <td colspan="2"><apex:outputText value="{!translations['house_booking_no']}"/></td>
                        <td colspan="3"><apex:outputText value=": "/><apex:outputText value="{!shipment.HouseBookingNo__c}"/></td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['hbl_hawb_no']}"/></td>
                        <td colspan="4"><apex:outputText value=": "/><apex:outputText value="{!shipment.HBL_Number_SEA_AIR__c}"/></td>
                        <td colspan="2"><apex:outputText value="{!translations['customs_no']}"/></td>
                        <td colspan="3"><apex:outputText value=": "/><apex:outputText value="{!shipment.CustomsClearanceDeclarationNo__c}"/></td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['mbl_hawb_no']}"/></td>
                        <td colspan="4"><apex:outputText value=": "/><apex:outputText value="{!shipment.MBL_Number_SEA_AIR__c}"/></td>
                        <td colspan="2"><apex:outputText value="{!translations['cargo_mode']}"/></td>
                        <td colspan="3">
                            <apex:outputText value=": "/>
                            <apex:outputPanel rendered="{!shipment.TranporationType__c == 'LCL' || shipment.TranporationType__c == 'AIR' || shipment.TranporationType__c == 'BULK'}">
                                
                                <apex:outputField value="{!shipment.TranporationType__c}"/>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!shipment.TranporationType__c == 'FCL' || shipment.TranporationType__c == 'MTY' || shipment.TranporationType__c == 'MTY & FCL'}">
                                {!shipment.TranporationType__c + ' : '}
                                <apex:outputPanel rendered="{!shipment.Container__c != null && shipment.ContainerNumber__c!= null}">
                                    {!shipment.Container__c} * {!shipment.ContainerNumber__c  }
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!shipment.Container2__c != null && shipment.ContainerNumber2__c!= null}">
                                    /{!shipment.Container2__c} * {!shipment.ContainerNumber2__c }
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!shipment.Container3__c != null && shipment.ContainerNumber3__c!= null}">
                                    /{!shipment.Container3__c} * {!shipment.ContainerNumber3__c }
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!shipment.Container4__c != null && shipment.ContainerNumber4__c!= null}">
                                    /{!shipment.Container4__c} * {!shipment.ContainerNumber4__c } 
                                </apex:outputPanel>
                                
                            </apex:outputPanel>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['flight_no']}"/></td>
                        <td colspan="4"><apex:outputText value=": "/><apex:outputText value="{!shipment.Vessle__c}/{!shipment.No_Voyage_Flight__c}"/></td>
                        <td colspan="2"><apex:outputText value="{!translations['package']}"/></td>
                        <td colspan="3">
                            <apex:outputText value=": "/><apex:outputText value="{!shipment.carton__c} {!translations[shipment.UnitType__c]}"/>
                            <apex:outputText value="(s)" rendered="{!language != 'vi'}"/>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['pol_aod']}"/></td>
                        <td colspan="4"><apex:outputText value=": "/><apex:outputText value="{!shipment.POL__r.Name}, {!shipment.POL__r.Country_Name__c}"/></td>
                        <td colspan="2"><apex:outputText value="{!translations['weight']}"/></td>
                        <td colspan="3"><apex:outputText value=": "/>
                            <!--<apex:outputText value="{!shipment.weight__c} KGS" rendered="{!shipment.weight__c != null}"/> -->
                            <apex:outputText value="{!formatStringUSDTotal} KGS" rendered="{!shipment.weight__c != null && !showChargeableWeight}">
                                <apex:param value="{!shipment.weight__c}" />
                            </apex:outputText>
                            <apex:outputText value="{!formatStringUSDTotal} KGS" rendered="{!shipment.chargable_weight__c != null && showChargeableWeight}">
                                <apex:param value="{!shipment.chargable_weight__c}" />
                            </apex:outputText>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['pod_aoa']}"/></td>
                        <td colspan="4"><apex:outputText value=": "/><apex:outputText value="{!shipment.POD__r.Name}, {!shipment.POD__r.Country_Name__c}"/></td>
                        <td colspan="2"><apex:outputText value="{!translations['meas']}"/></td>
                        <td colspan="3"><apex:outputText value=": "/><apex:outputText value="{!shipment.CBM__c} CBM" rendered="{!shipment.CBM__c != null}"/></td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['delivery']}"/></td>
                        <td colspan="4"><apex:outputText value=": "/><apex:outputText value="{!shipment.Place_Of_Delivery__r.Name}, {!shipment.Place_Of_Delivery__r.Country_Name__c}"/></td>
                        <td colspan="2"><apex:outputText value="{!translations['incoterms']}"/></td>
                        <td colspan="3"><apex:outputText value=": "/><apex:outputText value="{!shipment.PriceTerms__c}"/></td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['etd_eta']}"/> </td>
                        <td colspan="4">
                            <apex:outputText value=": "/>
                            <apex:outputText value="{!etdFormattedDate}">
                            </apex:outputText>
                            <apex:outputText value=" & "/>
                            <apex:outputText value="{!etaFormattedDate}">
                            </apex:outputText>
                        </td>
                        <td colspan="2"><apex:outputText value="{!translations['ex_rate']}"/></td>
                        <td colspan="3"><apex:outputText value=": "/>
                            <apex:outputText value="0" rendered="{!shipment.ExchangeRate__c == 0 || shipment.ExchangeRate__c == null}"/>
                            <apex:outputText value="{!formatStringVND}" rendered="{!shipment.ExchangeRate__c != 0 && shipment.ExchangeRate__c != null }">
                                <apex:param value="{!shipment.ExchangeRate__c}" />
                            </apex:outputText>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="Delivery Date"/> </td>
                        <td colspan="4">
                            <apex:outputText value=": "/>
                            <apex:outputText value="{!deliveryFormattedDate}"/>
                        </td>
                        <td colspan="2"></td>
                        <td colspan="3"></td>
                    </tr>
                    <tr>
                        <td colspan="2"><apex:outputText value="{!translations['container_no_seal']}"/> </td>
                        <td colspan="6"><apex:outputText value=": "/><apex:outputText value="{!shipment.CONTAINERSEALNO__c}"/></td>
                        
                    </tr>
                </table>


                <table style="width: 100%; border: 1px solid black; border-collapse: collapse; ">
                
                <!-- <tr style="border: 1px solid black !important;">
                    <td colspan="10" style="padding-top: 10px; border-width: 1px 1px 1px 1px; border-style: solid;">
                        
                    </td>
                </tr> -->
                <tr class="border" style="font-size:10pt">
                    <th colspan="1" style="border: thin solid; border-collapse: collapse; width:15px" ><apex:outputText value="{!translations['no']}"/></th>
                    <th colspan="2" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['description']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse; width:25px" ><apex:outputText value="{!translations['qty']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['unit']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['unit_price']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['curr']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['amount']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['tax']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['total_amount']}"/></th>
                    <th colspan="1" style="border: thin solid; border-collapse: collapse;" ><apex:outputText value="{!translations['note']}"/></th>
                    
                </tr>
                <tr style="border: thin solid; border-collapse: collapse;">
                    <td colspan="11" style="font-weight: bold; font-size:10pt" class="border" > <apex:outputText value="{!translations['freight_charge_surcharge']}"/> </td>
                </tr>
                <apex:variable var="indexBillWrapper" value="{!1}" />
                <apex:repeat value="{!listBillWrapper}" var="billWrapper">
                    <tr class="border">
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid; width:8px;">
                            <apex:outputText value="{!indexBillWrapper}"/>
                            <apex:variable var="indexBillWrapper" value="{!indexBillWrapper + 1}" />
                        </td>
                        <td colspan="2" class="border-left border-right" style="border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="{!billWrapper.descriptionEng}" rendered="{!language == 'en'}"/>
                            <apex:outputText value="{!billWrapper.description}" rendered="{!language != 'en'}"/>
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            {!billWrapper.quantity}
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            {!billWrapper.unit}
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:right; border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="0" rendered="{!billWrapper.curr == 'USD' && (billWrapper.unitPriceUSD == 0)}"/>
                            
                            <apex:outputText value="{!formatStringUSDDetail}" rendered="{!billWrapper.curr == 'USD' && billWrapper.unitPriceUSD != 0 && billWrapper.unitPriceUSD != null }">
                                <apex:param value="{!billWrapper.unitPriceUSD}" />
                            </apex:outputText>
							
                            <apex:outputText value="0" rendered="{!billWrapper.curr != 'USD' && (billWrapper.unitPriceVND == 0)}"/>
                            <apex:outputText value="{!formatStringVND}" rendered="{!billWrapper.curr != 'USD' && billWrapper.unitPriceVND != 0 && billWrapper.unitPriceVND != null}">
                                <apex:param value="{!billWrapper.unitPriceVND}" />
                            </apex:outputText>
                            
                            
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            {!billWrapper.curr}
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:right; border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="0" rendered="{!billWrapper.curr == 'USD' && (billWrapper.amountUSD == 0)}"/>
                            <apex:outputText value="{!formatStringUSDDetail}" rendered="{!billWrapper.curr == 'USD' && billWrapper.amountUSD != 0 && billWrapper.amountUSD != null}">
                                <apex:param value="{!billWrapper.amountUSD}" />
                            </apex:outputText>
                            <apex:outputText value="0" rendered="{!billWrapper.curr != 'USD' && (billWrapper.amountVND == 0)}"/>
                            <apex:outputText value="{!formatStringVND}" rendered="{!billWrapper.curr != 'USD' && billWrapper.amountVND != 0 && billWrapper.amountVND != null}">
                                <apex:param value="{!billWrapper.amountVND}" />
                            </apex:outputText>
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="0.00" rendered="{!billWrapper.tax == 0}"/>
                            <apex:outputText value="{!formatStringUSDTotal}" rendered="{!billWrapper.tax != 0 && billWrapper.tax != null}">
                                <apex:param value="{!billWrapper.tax}" />
                            </apex:outputText>
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:right; border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="0" rendered="{!billWrapper.curr == 'USD' && (billWrapper.totalAmountUSD == 0)}"/>
                            <apex:outputText value="{!formatStringUSDDetail}" rendered="{!billWrapper.curr == 'USD' && billWrapper.totalAmountUSD != 0 && billWrapper.totalAmountUSD != null}">
                                <apex:param value="{!billWrapper.totalAmountUSD}" />
                            </apex:outputText>
                            <apex:outputText value="0" rendered="{!billWrapper.curr != 'USD' && (billWrapper.totalAmountVND == 0)}"/>
                            <apex:outputText value="{!formatStringVND}" rendered="{!billWrapper.curr != 'USD' && billWrapper.totalAmountVND != 0 && billWrapper.totalAmountVND != null}">
                                <apex:param value="{!billWrapper.totalAmountVND}" />
                            </apex:outputText>
                        </td>
                        <td colspan="1" class="border-left border-right" style="border-left: thin solid; border-right: thin solid;">
                            {!billWrapper.note}
                        </td>
                    </tr>
                </apex:repeat>
                <tr style="border: thin solid; border-collapse: collapse;">
                    <td colspan="11" style="font-weight: bold; font-size:10pt" class="border"> <apex:outputText value="{!translations['pay_on_behalf']}"/> </td>
                </tr>
                <apex:variable var="indexBillWrapperOnBehalf" value="{!1}" />
                <apex:repeat value="{!listBillWrapperOnBehalf}" var="billWrapperOnBehalf">
                    <tr>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid; width:8px;">
                            <apex:outputText value="{!indexBillWrapperOnBehalf}"/>
                            <apex:variable var="indexBillWrapperOnBehalf" value="{!indexBillWrapperOnBehalf + 1}" />
                        </td>
                        <td colspan="2" class="border-left border-right" style="border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="{!billWrapperOnBehalf.descriptionEng}" rendered="{!language == 'en'}"/>
                            <apex:outputText value="{!billWrapperOnBehalf.description}" rendered="{!language != 'en'}"/>
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            {!billWrapperOnBehalf.quantity}
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            {!billWrapperOnBehalf.unit}
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:right; border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="0" rendered="{!billWrapperOnBehalf.curr == 'USD' && (billWrapperOnBehalf.unitPriceUSD == 0)}"/>
                            
                            <apex:outputText value="{!formatStringUSDDetail}" rendered="{!billWrapperOnBehalf.curr == 'USD' && billWrapperOnBehalf.unitPriceUSD != 0 && billWrapperOnBehalf.unitPriceUSD != null }">
                                <apex:param value="{!billWrapperOnBehalf.unitPriceUSD}" />
                            </apex:outputText>
							
                            <apex:outputText value="0" rendered="{!billWrapperOnBehalf.curr != 'USD' && (billWrapperOnBehalf.unitPriceVND == 0)}" />
                            <apex:outputText value="{!formatStringVND}" rendered="{!billWrapperOnBehalf.curr != 'USD' && billWrapperOnBehalf.unitPriceVND != 0 && billWrapperOnBehalf.unitPriceVND != null}">
                                <apex:param value="{!billWrapperOnBehalf.unitPriceVND}" />
                            </apex:outputText>
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            {!billWrapperOnBehalf.curr}
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:right; border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="0" rendered="{!billWrapperOnBehalf.curr == 'USD' && (billWrapperOnBehalf.amountUSD == 0)}"/>
                            <apex:outputText value="{!formatStringUSDDetail}" rendered="{!billWrapperOnBehalf.curr == 'USD' && billWrapperOnBehalf.amountUSD != 0 && billWrapperOnBehalf.amountUSD != null}">
                                <apex:param value="{!billWrapperOnBehalf.amountUSD}" />
                            </apex:outputText>
                            <apex:outputText value="0" rendered="{!billWrapperOnBehalf.curr != 'USD' && (billWrapperOnBehalf.amountVND == 0)}"/>
                            <apex:outputText value="{!formatStringVND}" rendered="{!billWrapperOnBehalf.curr != 'USD' && billWrapperOnBehalf.amountVND != 0 && billWrapperOnBehalf.amountVND != null}">
                                <apex:param value="{!billWrapperOnBehalf.amountVND}" />
                            </apex:outputText>
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:center; border-left: thin solid; border-right: thin solid;">
                            
                            
                            <apex:outputText value="0.00" rendered="{!billWrapperOnBehalf.tax == 0}"/>
                            <apex:outputText value="{!formatStringUSDTotal}" rendered="{!billWrapperOnBehalf.tax != 0 && billWrapperOnBehalf.tax != null}">
                                <apex:param value="{!billWrapperOnBehalf.tax}" />
                            </apex:outputText>
                        </td>
                        <td colspan="1" class="border-left border-right" style="text-align:right; border-left: thin solid; border-right: thin solid;">
                            <apex:outputText value="0" rendered="{!billWrapperOnBehalf.curr == 'USD' && (billWrapperOnBehalf.totalAmountUSD == 0)}"/>
                            <apex:outputText value="{!formatStringUSDDetail}" rendered="{!billWrapperOnBehalf.curr == 'USD' && billWrapperOnBehalf.totalAmountUSD != 0 && billWrapperOnBehalf.totalAmountUSD != null}">
                                <apex:param value="{!billWrapperOnBehalf.totalAmountUSD}" />
                            </apex:outputText>
                            <apex:outputText value="0" rendered="{!billWrapperOnBehalf.curr != 'USD' && (billWrapperOnBehalf.totalAmountVND == 0)}"/>
                            <apex:outputText value="{!formatStringVND}" rendered="{!billWrapperOnBehalf.curr != 'USD' && billWrapperOnBehalf.totalAmountVND != 0 && billWrapperOnBehalf.totalAmountVND != null}">
                                <apex:param value="{!billWrapperOnBehalf.totalAmountVND}" />
                            </apex:outputText>
                        </td>
                        <td class="border-left border-right" style="border-left: thin solid; border-right: thin solid;">
                            {!billWrapperOnBehalf.note}
                        </td>
                    </tr>
                </apex:repeat>
                <tr style="border: thin solid; border-collapse: collapse;">
                    <th colspan="7" style="font-weight: bold; font-size:10pt" class="border"> 
                        <apex:outputText value="{!translations['sub_total_excl_tax']}"/> 
                    </th>
                    <td colspan="2" class="border" style=" text-align:right;  font-size:10pt; font-weight: bold">
                        <apex:outputPanel rendered="{!curr == 'Both'}">
                            <apex:outputText value="{!formatStringUSDTotal}">
                                <apex:param value="{!subTotalUSD}" />
                            </apex:outputText>
                            <apex:outputText value=" USD"/>
                        </apex:outputPanel>
                    </td>
                    <td colspan="2" style=" text-align:right; font-size:10pt; font-weight: bold" class="border"> 
                        <apex:outputPanel rendered="{!curr == 'USD'}">
                            <apex:outputText value="{!formatStringUSDTotal}">
                                <apex:param value="{!subTotalUSD}" />
                            </apex:outputText>
                            <apex:outputText value=" USD"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!curr != 'USD'}">
                            <apex:outputText value="{!formatStringVND}">
                                <apex:param value="{!subTotalVND}" />
                            </apex:outputText>
                            <apex:outputText value=" VND"/>
                        </apex:outputPanel>
                        
                    </td>
                </tr>
                <tr style="border: thin solid; border-collapse: collapse;">
                    <th colspan="7" style="font-weight: bold; font-size:10pt" class="border"> 
                        <apex:outputText value="{!translations['grand_total']}"/> 
                    </th>
                    <td colspan="2" class="border" style=" text-align:right; font-size:10pt; font-weight: bold"> 
                        <apex:outputPanel rendered="{!curr == 'Both'}">
                            <apex:outputText value="{!formatStringUSDTotal}">
                                <apex:param value="{!grandTotalUSD}" />
                            </apex:outputText>
                            <apex:outputText value=" USD"/>
                        </apex:outputPanel>
                    </td>
                    <td colspan="2" style=" text-align:right; font-size:10pt; font-weight: bold" class="border">
                        <apex:outputPanel rendered="{!curr == 'USD'}">
                            <apex:outputText value="{!formatStringUSDTotal}">
                                <apex:param value="{!grandTotalUSD}" />
                            </apex:outputText>
                            <apex:outputText value=" USD"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!curr != 'USD'}">
                            <apex:outputText value="{!formatStringVND}">
                                <apex:param value="{!grandTotalVND}" />
                            </apex:outputText>
                            <apex:outputText value=" VND"/> 
                        </apex:outputPanel>
                    </td>
                </tr>
            </table>
            <div class="amount-in-word" width="100%" style="min-height: 50px; padding-top: 10px;">
                <table width="100%">
                    <tr>
                        <td style="font-weight: bold; font-size:10pt; border-bottom: 1px solid black; border-collapse: collapse; padding 10px;" align="left" valign="middle" colspan="2" rowspan="2">
                            <apex:outputText value="{!sayUppercaseLabel}"/>:
                        </td>
                        <td colspan="9" rowspan="2" style="border-bottom: 1px solid black; border-collapse: collapse;">
                            <apex:outputText value="{!grandTotalUSDInENWording}" rendered="{!language != 'vi' && (curr == 'USD' || curr == 'Both')}"/>
                            
                            <apex:outputText value="{!grandTotalUSDInVNWording}" rendered="{!language == 'vi' && (curr == 'USD' || curr == 'Both')}"/>

                            <apex:outputPanel rendered="{!curr == 'Both'}"><br/></apex:outputPanel>

                            <apex:outputText value="{!grandTotalVNDInENWording}" rendered="{!language != 'vi' && (curr == 'VND' || curr == 'Both')}"/>
                            <apex:outputText value="{!grandTotalVNDInVNWording}" rendered="{!language == 'vi' && (curr == 'VND' || curr == 'Both')}"/>
                        </td>
                    </tr>
                </table>
            </div>
            <br/>
            <br/>
            <table width="100%">
                <td colspan="11">
                <apex:outputText value="{!translations['remark']}" style="font-weight: bold; font-size:10pt"/>:
                <br/>
                <apex:outputText value="{!shipment.SeikyusyoRemark__c}"/>
                </td>
            </table>
            <br/>
            <br/>
            <div class="bank-info-signature" width="100%" style="padding-top: 10px;">
                <table width="100%">
                    <tr>
                        <td colspan="5" style="font-weight: bold; font-size:10pt"><apex:outputPanel rendered="{!templateType == 'official'}"><apex:outputText value="{!translations['bank_account_information']}" />:</apex:outputPanel></td>
                        <td colspan="6" align="center" style="font-weight: bold; font-size:10pt"><apex:outputText value="{!translations['authorized_signature']}"/></td>
                    </tr>
                    
                    <apex:outputPanel rendered="{!templateType == 'official'}">
                    
                        <tr>
                            <td colspan="2"><apex:outputText value="{!translations['account_name']}"/></td>
                            <td colspan="3">
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Account_1__c}" rendered="{!bankType == 'local1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Account_2__c}" rendered="{!bankType == 'local2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Account_3__c}" rendered="{!bankType == 'local3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Account_4__c}" rendered="{!bankType == 'local4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Account_5__c}" rendered="{!bankType == 'local5'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Account_1__c}" rendered="{!bankType == 'foreign1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Account_2__c}" rendered="{!bankType == 'foreign2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Account_3__c}" rendered="{!bankType == 'foreign3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Account_4__c}" rendered="{!bankType == 'foreign4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Account_5__c}" rendered="{!bankType == 'foreign5'}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"><apex:outputText value="{!translations['bank_name']}"/></td>
                            <td colspan="3">
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Name_1__c}" rendered="{!bankType == 'local1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Name_2__c}" rendered="{!bankType == 'local2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Name_3__c}" rendered="{!bankType == 'local3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Name_4__c}" rendered="{!bankType == 'local4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Name_5__c}" rendered="{!bankType == 'local5'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Name_1__c}" rendered="{!bankType == 'foreign1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Name_2__c}" rendered="{!bankType == 'foreign2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Name_3__c}" rendered="{!bankType == 'foreign3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Name_4__c}" rendered="{!bankType == 'foreign4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Name_5__c}" rendered="{!bankType == 'foreign5'}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"><apex:outputText value="{!translations['bank_address']}"/></td>
                            <td colspan="3">
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Address_1__c}" rendered="{!bankType == 'local1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Address_2__c}" rendered="{!bankType == 'local2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Address_3__c}" rendered="{!bankType == 'local3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Address_4__c}" rendered="{!bankType == 'local4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_Address_5__c}" rendered="{!bankType == 'local5'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Address_1__c}" rendered="{!bankType == 'foreign1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Address_2__c}" rendered="{!bankType == 'foreign2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Address_3__c}" rendered="{!bankType == 'foreign3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Address_4__c}" rendered="{!bankType == 'foreign4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_Address_5__c}" rendered="{!bankType == 'foreign5'}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"><apex:outputText value="{!translations['swift_code']}"/></td>
                            <td colspan="3">
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_1_Other__c}" rendered="{!bankType == 'local1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_2_Other__c}" rendered="{!bankType == 'local2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_3_Other__c}" rendered="{!bankType == 'local3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_4_Other__c}" rendered="{!bankType == 'local4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Bank_5_Other__c}" rendered="{!bankType == 'local5'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_1_Other__c}" rendered="{!bankType == 'foreign1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_2_Other__c}" rendered="{!bankType == 'foreign2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_3_Other__c}" rendered="{!bankType == 'foreign3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_4_Other__c}" rendered="{!bankType == 'foreign4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Bank_5_Other__c}" rendered="{!bankType == 'foreign5'}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2"><apex:outputText value="{!translations['account_no']}"/></td>
                            <td colspan="3">
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Account_No_1__c}" rendered="{!bankType == 'local1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Account_No_2__c}" rendered="{!bankType == 'local2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Account_No_3__c}" rendered="{!bankType == 'local3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Account_No_4__c}" rendered="{!bankType == 'local4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Local_Account_No_5__c}" rendered="{!bankType == 'local5'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Account_No_1__c}" rendered="{!bankType == 'foreign1'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Account_No_2__c}" rendered="{!bankType == 'foreign2'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Account_No_3__c}" rendered="{!bankType == 'foreign3'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Account_No_4__c}" rendered="{!bankType == 'foreign4'}"/>
                                <apex:outputText value=": {!$Setup.Site_Custom_Settings__c.Foreign_Account_No_5__c}" rendered="{!bankType == 'foreign5'}"/>
                            </td>
                        </tr>
                    
                </apex:outputPanel>
                        
                    
                </table>
            </div>
        </div>
        <br/>
        <br/>
        <br/>
        <br/>
        <br/>
        <!--
        <table width="100%">
            <td colspan="11">
                <div class="footer" style="clear:both; width: 800px">
                    <div class="footerRight" style="float:left; width: 45%; text-align: right;">
                        Powered by AFR Solutions Co., Ltd.
                    </div>
                </div>
            </td>
        </table>
        -->
    </body>
</apex:page>